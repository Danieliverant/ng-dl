!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ng-dl/numeric-input",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["ng-dl"]=e["ng-dl"]||{},e["ng-dl"]["numeric-input"]={}),e.ng.core,e.ng.forms,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,n,o){"use strict";var a=new t.InjectionToken("NUMERIC_INPUT_LOCALE"),i=function(){function e(e){this.locales=e}return e.prototype.getDecimalSeparators=function(){var e=this,t=this.getLocales(),r={useGrouping:!1};return t.map((function(t){return e.localizedToDecimalSeparator(e.localizeDecimal(1.1,t,r))}))},e.prototype.getThousandSeparators=function(){var e=this,t=this.getLocales(),r={useGrouping:!0};return t.map((function(t){return e.localizedToThousandSeparator(e.localizeDecimal(1234.5,t,r))}))},e.prototype.localizeNumber=function(e){return e.toLocaleString(this.getLocales())},e.prototype.localizedToDecimalSeparator=function(e){return e.find((function(e){return"decimal"===e.type})).value},e.prototype.localizedToThousandSeparator=function(e){return e.find((function(e){return"group"===e.type})).value},e.prototype.localizeDecimal=function(e,t,r){return Intl.NumberFormat(t,r).formatToParts(e)},Object.defineProperty(e.prototype,"localeFromBrowser",{get:function(){return navigator.languages?navigator.languages[0]:navigator.language},enumerable:!1,configurable:!0}),e.prototype.getLocales=function(){try{return Intl.NumberFormat.supportedLocalesOf(this.locales)}catch(e){return[this.localeFromBrowser]}},e}();i.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new i(t.ɵɵinject(a,8))},token:i,providedIn:"root"}),i.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],i.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[a]},{type:t.Optional}]}]};Object.create;function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}Object.create;var s="^[0-9]*$",l="^-?[0-9]+(.[0-9]+)?$",p=/\d/g,f=["a","c","v","x"],d=["Backspace","ArrowLeft","ArrowRight","Escape","Tab"];function h(e,t,r){var n=Number(function(e,t,r){return e=function(e,t){return e.replace(t,"")}(e=function(e,t){if(e.charAt(0)===t)return 0+e;if(e.charAt(e.length-1)===t)return e+0;return e}(e=function(e,t){var r=e.replace("-","").replace(p,"");return e.replace(r||t,t)}(e,t),t),r),new RegExp(l).test(e)?e:(0).toString()}(e,t,r).replace(t,"."));return isNaN(n)?0:n}function m(e,t){var r=y(e);return function(e,t){var r=c(d),n=e.target.value,o=e.target.selectionStart||0,a=n.includes("-"),i=t.some((function(e){return n.includes(e)}));a&&o<=1||i||r.push.apply(r,c(t));var u=t.some((function(e){return n.charAt(0)===e}));a||u||0!==o||r.push("-");return r}(e,t).includes(r)||f.includes(r)&&function(e){return e.ctrlKey||e.metaKey}(e)||function(e){var t=y(e);return new RegExp(s).test(t)}(e)}function y(e){return e.key||function(e){if(e&&String.fromCharCode)switch(e){case 8:return"Backspace";case 9:return"Tab";case 27:return"Escape";case 37:return"ArrowLeft";case 39:return"ArrowRight";case 188:return",";case 190:return".";case 109:case 173:case 189:return"-";default:return String.fromCharCode(e)}return""}(e.keyCode)}var g=function(){function e(e,r,o){this.hostElement=e,this.localeService=r,this.control=o,this.localized=new t.EventEmitter,this.decimalSeparators=this.localeService.getDecimalSeparators(),this.thousandSeparators=this.localeService.getThousandSeparators(),this.destroy$=new n.Subject}return e.prototype.ngAfterViewInit=function(){var e;(e=this.el).setAttribute("type","text"),e.setAttribute("inputmode","decimal"),e.removeAttribute("pattern"),this.onKeyDown(),this.onFormSubmit(),this.onValueChange()},e.prototype.ngOnDestroy=function(){this.destroy$.next()},e.prototype.setValue=function(e){var t,r=h(e,this.decimalSeparator,this.thousandsSeparator);this.localized.emit(this.localeService.localizeNumber(r)),this.el.value=r.toString(),this.control&&(null===(t=this.control.control)||void 0===t||t.patchValue(r))},e.prototype.onChange=function(){var e=this;return n.fromEvent(this.el,"change").pipe(o.map((function(){return e.el.value})))},e.prototype.onPaste=function(){return n.fromEvent(this.el,"paste").pipe(o.tap((function(e){return e.preventDefault()})),o.map((function(e){var t;return(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/plain"))||""})))},e.prototype.onDrop=function(){return n.fromEvent(this.el,"drop").pipe(o.tap((function(e){return e.preventDefault()})),o.map((function(e){var t;return(null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("text"))||""})))},e.prototype.onKeyDown=function(){var e=this;n.fromEvent(this.el,"keydown").pipe(o.takeUntil(this.destroy$),o.tap((function(t){e.el.setCustomValidity(""),m(t,e.decimalSeparators)||t.preventDefault()}))).subscribe()},e.prototype.onFormSubmit=function(){var e=this;n.fromEvent(this.el.form,"submit").pipe(o.takeUntil(this.destroy$),o.tap((function(t){var r,n,o,a,i=h(e.el.value,e.decimalSeparator,e.thousandsSeparator);(r=e.el,n=i,o=e.min,a=e.max,n<o?(r.setCustomValidity("Value must be greater than or equal to "+o+"."),!1):n>a?(r.setCustomValidity("Value must be less than or equal to "+a+"."),!1):(r.setCustomValidity(""),!0))||(t.preventDefault(),e.el.reportValidity())}))).subscribe()},e.prototype.onValueChange=function(){var e=this;n.merge(this.onChange(),this.onDrop(),this.onPaste()).pipe(o.takeUntil(this.destroy$)).subscribe((function(t){return e.setValue(t)}))},Object.defineProperty(e.prototype,"el",{get:function(){return this.hostElement.nativeElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decimalSeparator",{get:function(){return this.decimalSeparators[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thousandsSeparator",{get:function(){return this.thousandSeparators[0]},enumerable:!1,configurable:!0}),e}();g.decorators=[{type:t.Directive,args:[{selector:"[dlNumericInput]"}]}],g.ctorParameters=function(){return[{type:t.ElementRef},{type:i},{type:r.NgControl,decorators:[{type:t.Optional}]}]},g.propDecorators={min:[{type:t.Input}],max:[{type:t.Input}],localized:[{type:t.Output}]};var v=function(){};v.decorators=[{type:t.NgModule,args:[{declarations:[g],imports:[],exports:[g]}]}],e.NUMERIC_INPUT_LOCALE=a,e.NumericInputModule=v,e.ɵa=g,e.ɵb=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-dl-numeric-input.umd.min.js.map